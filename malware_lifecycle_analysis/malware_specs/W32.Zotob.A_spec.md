# Спецификация вируса `W32.Zotob.A`

Эксплуатирует уязвимость в сервисе Microsoft Windows Plug and Play, описанную в бюллетене безопасности MS05-039.

Не заражает компьютеры под управлением Windows 95/98/Me/NT4, но они могут использоваться для заражения других уязвимых компьютеров.

При запуске:

1. Создаёт флаг `B-O-T-Z-O-R` для того, чтобы только одна копия червя
выполнялась на скомпрометированном компьютере.

2. Копирует себя как `%System%\botzor.exe`.

3. Добавляет значение `WINDOWS SYSTEM = botzor.exe` в ключах реестра:

    - `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`
    - `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices`

4. Изменяет значение `Start = 4` в ключе реестра `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess`, чтобы отключить сервис Shared Access в Windows 2000/XP.

5. Соединяется с IRC сервером на домене `[http://]diabl0.turkcoders.net/[REMOVED]` по TCP порту `8080`, что даёт удалённый неавторизованный доступ.

6. Открывает FTP сервер по TCP-порту `33333`.

7. Генерирует случайный IP-адрес из текущего, оставляя первые его два октета.
Например, если IP-адрес системы 192.168.0.1, червь попытается заразить IP-адреса 192.168.x.x

8. Пытается распространиться на компьютеры со случайными IP-адресами, открывая бекдор на TCP-порту `8888` на удалённом компьютере.

9. Копирует файл `%System%\2pac.txt` в скомпрометированный компьютер и выполняет FTP-скрипт, содержащийся в нём.

10. Загружает и выполняет копию червя `%System%\haha.exe` с предварительно созданного FTP-сервера на заражённом компьютере.

11. Добавляет в хост файл следующее:

    ```text
    Made By .... Greetz to good friend [REMOVED] in the next 24hours!!!
    127.0.0.1 www.symantec.com
    127.0.0.1 securityresponse.symantec.com
    127.0.0.1 symantec.co
    127.0.0.1 www.sophos.com
    127.0.0.1 sophos.com
    127.0.0.1 www.mcafee.com
    ```
